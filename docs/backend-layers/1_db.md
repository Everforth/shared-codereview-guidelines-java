## DB層（Entity定義, 型定義, スキーマ定義 等）

### 必須チェック項目：

- データモデル設計: 何をしたいからどういうデータモデルであるべきかの意図が明確で適切か
- 命名規則: テーブル名やカラム名が業務の意味を正確に表現し、一貫性があるか
- 制約設計: 状態を極力持たず、DB制約でデータの整合性を保証することでService層のif文を減らしているか
- nullable設計:
  - 基本NOT NULLとし、DBスキーマ制約で担保する
  - 値なしに意味がある場合のみnullableにし、optionalとして扱う
  - 区別不要なら`DEFAULT ''`を使用する
- リレーションのnullable設計:
  - 両側で異なるnullable設定は正当であり、整合性の問題として指摘しないこと
  - 親エンティティ側では子が存在しない場合があればnullableとする
  - 子エンティティ側では親への参照は通常必須となる
  - 外部キーカラムがNOT NULLで、リレーション側がnullableでも問題ない
- 型設計: 既存型定義を再利用しているか
- DB操作: JPA/Hibernateクエリが最適化され、N+1問題を避けているか
- Enum定義: Enumを Entity内に書かず、専用のenum/typeファイルに分離する（ @shared-codereview-guidelines-java/docs/backend-layers/B_Enum定義.md を参照）
- デフォルト値: カラムに適切なdefault値を設定し、マジックナンバーではなく定義済み定数を使用する
- 外部キー定義: リレーションを定義する場合、対応する外部キーカラムも明示的に定義する
- Entityのコンストラクタ: JPAで必要な引数なしコンストラクタを維持しつつ、必要に応じて必須引数で生成できる経路を用意する
- 情報の重複回避: 他のカラムやリレーションから導出可能な情報は、別カラムとして持たない
- リレーションの優先: 会社名などマスタデータを参照すべき値は、文字列カラムではなくリレーションで定義する
- その他のJPA/Hibernateの慣習尊重: デフォルト値の明示やコンストラクタでの全プロパティ初期化など、他の項目以外に対してJPA/Hibernateの一般的なパターンに反する指摘をしない

### パフォーマンス考慮点：

- バッチ処理での一括操作
- 不要なDB呼び出しの削減

### 設計考慮点：

- Migrationの適切な統合
- 既存データがあるテーブルにNOT NULLカラムを追加する場合、一時的にdefault値を設定し削除用のTODOを残す

### 正当な設計パターン：

- リレーションの両側で異なるnullable設定
- NOT NULL制約の表現方法の違い（DBスキーマ定義とJPAマッピング）
- 代替設計パターンの提案（シングルトン化、別モジュールへの統合など）

### この層で扱わないこと：

- DTOファイル（Controller層の責務）
- CRUD処理の実装（Service層の責務）
- ビジネスロジック（Service層の責務）
- APIエンドポイントの定義（Controller層の責務）
